<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Canada Immigration Levels Plan 2026–2028 — Official IRCC Data</title>

  <!-- Tailwind + Chart.js -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b1220; --bg2:#10193a; --text:#e6efff; --muted:#bcd2ea; --ring:#ffffff26;

      --c-pr:#60a5fa;   /* PR */
      --c-tr:#34d399;   /* TR generic */
      --c-econ:#f59e0b; /* Economic */
      --c-old:#94a3b8;  /* Old plan */

      --c-imp:#3b82f6;  /* IMP */
      --c-tfw:#14b8a6;  /* TFW */
      --c-stu:#a78bfa;  /* Students */

      --chart-h-mobile:15rem;
      --chart-h-desktop:22rem;
    }

    body{
      font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:linear-gradient(180deg,var(--bg) 0%,var(--bg2) 100%);
      color:var(--text);
    }

    .card{
      background:rgba(255,255,255,0.04);
      border:1px solid var(--ring);
      border-radius:1.25rem;
      box-shadow:0 8px 24px rgba(0,0,0,.25);
    }

    .chip{
      display:inline-flex;align-items:center;gap:.45rem;
      padding:.25rem .6rem;border-radius:999px;
      border:1px solid var(--ring);
      background:rgba(255,255,255,.06)
    }

    .eq-grid{grid-auto-rows:1fr;}

    figure.chart-card{
      position:relative;
      display:flex;flex-direction:column;height:100%;
      background:rgba(255,255,255,.05);
      border-radius:1rem;padding:1rem;
    }
    figure.chart-card>figcaption{
      display:flex; align-items:center; gap:.5rem;
      margin-bottom:.5rem;opacity:.9;font-size:.95rem;
    }

    .chartWrap{flex:1;min-height:var(--chart-h-mobile);}
    @media(min-width:1024px){.chartWrap{min-height:var(--chart-h-desktop);}}
    @media(min-width:1280px){.chartWrap{min-height:24rem;}}

    /* Simple tooltip (pure CSS) */
    .tip{position:relative; cursor:help; border-bottom:1px dotted rgba(255,255,255,.35);}
    .tip[data-tip]:hover::after{
      content:attr(data-tip);
      position:absolute; z-index:40;
      left:0; top:120%;
      max-width:22rem;
      padding:.5rem .6rem;
      border-radius:.5rem;
      color:#fff; background:rgba(0,0,0,.75);
      border:1px solid rgba(255,255,255,.15);
      font-size:.75rem; line-height:1.2;
      white-space:normal;
      box-shadow:0 6px 18px rgba(0,0,0,.35);
    }
    .tip-icon{
      display:inline-flex; align-items:center; justify-content:center;
      width:1.15rem; height:1.15rem; border-radius:999px;
      background:rgba(255,255,255,.08); border:1px solid var(--ring);
    }
    .icon { width:1rem; height:1rem; opacity:.95 }
    .icon-cap { color: var(--c-stu) }
    .icon-briefcase { color: var(--c-imp) }
    .icon-transfer { color: var(--c-tfw) }

    /* === 3D Isometric Human Figures === */
    .iso-row{
      display:grid; grid-template-columns:repeat(12,minmax(0,1fr));
      gap:.75rem; align-items:end;
    }
    @media (max-width:1024px){ .iso-row{ grid-template-columns:repeat(8,minmax(0,1fr)); } }
    @media (max-width:640px){ .iso-row{ grid-template-columns:repeat(6,minmax(0,1fr)); } }

    .iso-human{
      position:relative; aspect-ratio:3/5; border-radius:.9rem;
      background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
      border:1px solid var(--ring); overflow:hidden;
      box-shadow:0 10px 26px rgba(0,0,0,.35);
      transform:skewY(-6deg) rotateX(10deg) rotateZ(-2deg);
      transform-origin:bottom center;
      transition:transform .18s ease, box-shadow .18s ease;
    }
    .iso-human:hover{
      transform:skewY(-4deg) rotateX(6deg) rotateZ(0deg) translateY(-2px);
      box-shadow:0 14px 30px rgba(0,0,0,.45);
    }

    .iso-human svg{ width:100%; height:100%; filter: drop-shadow(0 4px 8px rgba(0,0,0,.25)); }
    .iso-shadow{
      position:absolute; left:10%; right:10%; bottom:8%;
      height:14%; filter:blur(3px);
      background:radial-gradient(ellipse at 50% 50%, rgba(0,0,0,.45) 0%, transparent 60%);
    }

    /* category tints */
    .iso-human.student { --pc: var(--c-stu) }
    .iso-human.imp     { --pc: var(--c-imp) }
    .iso-human.tfw     { --pc: var(--c-tfw) }

    /* small legend tokens */
    .token{display:inline-flex;align-items:center;gap:.4rem;padding:.15rem .5rem;border:1px solid var(--ring);
      border-radius:999px;background:rgba(255,255,255,.06);font-size:.75rem}
    .token .dot{width:.7rem;height:.7rem;border-radius:50%}

    /* --- Stylized Canada “map” (regional spotlight) --- */
    .map-card{
      background:rgba(255,255,255,.05); border-radius:1rem; padding:1rem;
      border:1px solid var(--ring);
    }
    .map-grid{
      display:grid; grid-template-columns: 1.2fr 1fr; gap:1rem;
    }
    @media (max-width:1024px){ .map-grid{ grid-template-columns: 1fr } }
  </style>
</head>

<body class="min-h-screen">

<!-- HEADER -->
<header class="max-w-7xl mx-auto px-6 pt-10 pb-6">
  <div class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6">
    <div>
      <h1 class="text-4xl lg:text-5xl font-extrabold leading-tight">
        Canada’s Immigration Levels Plan <span class="text-sky-400">2026–2028</span>
      </h1>
      <p class="opacity-80 mt-2">
        Visualizing official IRCC targets for Permanent and Temporary Residents, with Old vs New comparisons.
      </p>
    </div>

    <!-- Chips with icons -->
    <div class="flex flex-wrap items-center gap-2 text-sm">
      <span class="chip">
        <svg class="icon" viewBox="0 0 24 24" fill="currentColor" style="color:#60a5fa"><circle cx="12" cy="12" r="4"/></svg>
        PR
      </span>
      <span class="chip">
        <svg class="icon" viewBox="0 0 24 24" fill="currentColor" style="color:#34d399"><rect x="3" y="7" width="18" height="10" rx="2"/></svg>
        TR
      </span>
      <span class="chip">
        <svg class="icon" viewBox="0 0 24 24" fill="currentColor" style="color:#f59e0b"><path d="M3 12h18M12 3v18"/></svg>
        Economic
      </span>
      <span class="chip">
        <svg class="icon" viewBox="0 0 24 24" fill="currentColor" style="color:#94a3b8"><path d="M4 6h16v12H4z"/></svg>
        Old Plan
      </span>
    </div>
  </div>
</header>

<!-- KPI ROW -->
<section class="max-w-7xl mx-auto px-6 pb-4 grid grid-cols-1 sm:grid-cols-3 gap-4">

  <article class="card p-5">
    <div class="text-sm opacity-80">Annual PR Target (New Plan)</div>
    <div class="mt-2 flex items-end gap-2">
      <div class="text-3xl font-extrabold">380,000</div>
      <div class="text-xs opacity-70">set for 2026–2028</div>
    </div>
    <div class="mt-3 h-2 rounded-full bg-white/10">
      <div class="h-2 rounded-full bg-sky-400" style="width:76%"></div>
    </div>
  </article>

  <article class="card p-5">
    <div class="text-sm opacity-80">New TR Arrivals Targets</div>
    <div class="mt-2 text-2xl font-extrabold text-emerald-300">385k → 370k → 370k</div>
    <div class="text-xs opacity-70">2026 → 2027 → 2028</div>
  </article>

  <article class="card p-5">
    <div class="text-sm opacity-80">Students (New Arrivals)</div>
    <div class="mt-2 text-3xl font-extrabold text-violet-300">155k → 150k → 150k</div>
    <div class="text-xs opacity-70">2026 → 2027 → 2028</div>
  </article>

</section>

<!-- MAIN -->
<main class="max-w-7xl mx-auto px-6 pb-10 grid grid-cols-1 gap-6">

  <!-- CHAPTER 1 -->
  <section class="card p-6">
    <h2 class="text-2xl font-bold">Chapter 1 — Permanent Residents (PR)</h2>

    <div class="mt-5 grid grid-cols-1 lg:grid-cols-2 gap-6 eq-grid">

      <figure class="chart-card">
        <figcaption>PR Admissions Target (by year): Old vs New</figcaption>
        <div class="chartWrap"><canvas id="chartPR"></canvas></div>
      </figure>

      <figure class="chart-card">
        <figcaption>PR Class Split — 2026 (Economic, Family, Refugee & Other)</figcaption>
        <div class="chartWrap"><canvas id="chartClass2026"></canvas></div>
      </figure>

    </div>
  </section>

  <!-- CHAPTER 2 -->
  <section class="card p-6">
    <div class="flex items-center justify-between flex-wrap gap-3">
      <h2 class="text-2xl font-bold">Chapter 2 — Temporary Residents (TR)</h2>

      <!-- Quick explainer with tooltips -->
      <div class="flex flex-wrap items-center gap-2 text-xs">
        <span class="chip tip" data-tip="Students = New international student entries (e.g., study permits leading to PGWP eligibility).">
          <span class="tip-icon"><svg class="icon icon-cap" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="m3 7 9-4 9 4-9 4-9-4Z"/><path d="M21 10v6"/><path d="M12 11v9"/></svg></span>
          Students
        </span>
        <span class="chip tip" data-tip="IMP = International Mobility Program (LMIA-exempt; e.g., PGWP, SOWP, IEC, intra-company transfers).">
          <span class="tip-icon"><svg class="icon icon-briefcase" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="7" width="18" height="12" rx="2"/><path d="M8 7V5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></span>
          IMP (LMIA-exempt)
        </span>
        <span class="chip tip" data-tip="TFW = Temporary Foreign Worker Program (LMIA-required; employer-specific).">
          <span class="tip-icon"><svg class="icon icon-transfer" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M8 7h8l-3-3m3 13H8l3 3"/><circle cx="6" cy="18" r="2"/><circle cx="18" cy="6" r="2"/></svg></span>
          TFW (LMIA-required)
        </span>
      </div>
    </div>

    <div class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6 eq-grid">

      <figure class="chart-card">
        <figcaption>
          <svg class="icon icon-briefcase" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><rect x="3" y="7" width="18" height="12" rx="2"/><path d="M8 7V5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
          New TR Arrivals — Students / IMP / TFW (Old vs New)
        </figcaption>
        <div class="chartWrap"><canvas id="chartTRStack"></canvas></div>
      </figure>

      <figure class="chart-card">
        <figcaption>
          <svg class="icon icon-cap" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="m3 7 9-4 9 4-9 4-9-4Z"/><path d="M21 10v6"/><path d="M12 11v9"/></svg>
          International Students — New Arrivals (Old vs New)
        </figcaption>
        <div class="chartWrap"><canvas id="chartStudents"></canvas></div>
      </figure>

    </div>
  </section>

  <!-- 3D ISOMETRIC HUMAN FIGURES -->
  <section class="card p-6">
    <div class="flex items-center justify-between flex-wrap gap-3">
      <h2 class="text-2xl font-bold">People in the Data — 3D Isometric Strip</h2>
      <div class="flex flex-wrap gap-2">
        <span class="token"><span class="dot" style="background:var(--c-stu)"></span>Student</span>
        <span class="token"><span class="dot" style="background:var(--c-imp)"></span>IMP</span>
        <span class="token"><span class="dot" style="background:var(--c-tfw)"></span>TFW</span>
        <span class="token">1 figure ≈ 25k people (example)</span>
      </div>
    </div>

    <!-- Example mix: 6 Students, 4 IMP, 2 TFW (12 total). Adjust counts to match your story. -->
    <div class="iso-row mt-4">
      <!-- STUDENTS x6 -->
      <div class="iso-human student">
        <svg viewBox="0 0 120 200" xmlns="http://www.w3.org/2000/svg">
          <defs><linearGradient id="gStu1" x1="0" y1="0" x2="0" y2="1"><stop offset="0%"  stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs>
          <circle cx="60" cy="44" r="20" fill="url(#gStu1)"/><polygon points="20,34 60,18 100,34 60,50" fill="rgba(0,0,0,.25)"/>
          <rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gStu1)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gStu1)"/>
          <rect x="34" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="70" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/>
          <rect x="38" y="64" width="6" height="64" fill="rgba(255,255,255,.18)"/>
        </svg><div class="iso-shadow"></div>
      </div>
      <div class="iso-human student"><svg viewBox="0 0 120 200"><defs><linearGradient id="gStu2" x1="0" y="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gStu2)"/><polygon points="20,34 60,18 100,34 60,50" fill="rgba(0,0,0,.25)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gStu2)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gStu2)"/><rect x="34" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="70" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="38" y="64" width="6" height="64" fill="rgba(255,255,255,.18)"/></svg><div class="iso-shadow"></div></div>
      <div class="iso-human student"><svg viewBox="0 0 120 200"><defs><linearGradient id="gStu3" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gStu3)"/><polygon points="20,34 60,18 100,34 60,50" fill="rgba(0,0,0,.25)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gStu3)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gStu3)"/><rect x="34" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="70" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="38" y="64" width="6" height="64" fill="rgba(255,255,255,.18)"/></svg><div class="iso-shadow"></div></div>
      <div class="iso-human student"><svg viewBox="0 0 120 200"><defs><linearGradient id="gStu4" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gStu4)"/><polygon points="20,34 60,18 100,34 60,50" fill="rgba(0,0,0,.25)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gStu4)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gStu4)"/><rect x="34" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="70" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="38" y="64" width="6" height="64" fill="rgba(255,255,255,.18)"/></svg><div class="iso-shadow"></div></div>
      <div class="iso-human student"><svg viewBox="0 0 120 200"><defs><linearGradient id="gStu5" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gStu5)"/><polygon points="20,34 60,18 100,34 60,50" fill="rgba(0,0,0,.25)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gStu5)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gStu5)"/><rect x="34" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="70" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="38" y="64" width="6" height="64" fill="rgba(255,255,255,.18)"/></svg><div class="iso-shadow"></div></div>
      <div class="iso-human student"><svg viewBox="0 0 120 200"><defs><linearGradient id="gStu6" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gStu6)"/><polygon points="20,34 60,18 100,34 60,50" fill="rgba(0,0,0,.25)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gStu6)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gStu6)"/><rect x="34" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="70" y="128" width="16" height="52" rx="4" fill="rgba(255,255,255,.18)"/><rect x="38" y="64" width="6" height="64" fill="rgba(255,255,255,.18)"/></svg><div class="iso-shadow"></div></div>

      <!-- IMP x4 -->
      <div class="iso-human imp"><svg viewBox="0 0 120 200" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gImp1" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gImp1)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gImp1)"/><rect x="46" y="94" width="28" height="16" rx="3" fill="rgba(0,0,0,.25)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gImp1)"/></svg><div class="iso-shadow"></div></div>
      <div class="iso-human imp"><svg viewBox="0 0 120 200"><defs><linearGradient id="gImp2" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gImp2)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gImp2)"/><rect x="46" y="94" width="28" height="16" rx="3" fill="rgba(0,0,0,.25)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gImp2)"/></svg><div class="iso-shadow"></div></div>
      <div class="iso-human imp"><svg viewBox="0 0 120 200"><defs><linearGradient id="gImp3" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gImp3)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gImp3)"/><rect x="46" y="94" width="28" height="16" rx="3" fill="rgba(0,0,0,.25)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gImp3)"/></svg><div class="iso-shadow"></div></div>
      <div class="iso-human imp"><svg viewBox="0 0 120 200"><defs><linearGradient id="gImp4" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gImp4)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gImp4)"/><rect x="46" y="94" width="28" height="16" rx="3" fill="rgba(0,0,0,.25)"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gImp4)"/></svg><div class="iso-shadow"></div></div>

      <!-- TFW x2 -->
      <div class="iso-human tfw"><svg viewBox="0 0 120 200" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="gTfw1" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gTfw1)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gTfw1)"/><path d="M40 100 h40" stroke="rgba(0,0,0,.35)" stroke-width="6"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gTfw1)"/></svg><div class="iso-shadow"></div></div>
      <div class="iso-human tfw"><svg viewBox="0 0 120 200"><defs><linearGradient id="gTfw2" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--pc)"/><stop offset="100%" stop-color="var(--pc)" stop-opacity=".75"/></linearGradient></defs><circle cx="60" cy="44" r="20" fill="url(#gTfw2)"/><rect x="38" y="64" width="44" height="64" rx="12" fill="url(#gTfw2)"/><path d="M40 100 h40" stroke="rgba(0,0,0,.35)" stroke-width="6"/><rect x="50" y="128" width="20" height="52" rx="4" fill="url(#gTfw2)"/></svg><div class="iso-shadow"></div></div>
    </div>

    <p class="mt-3 text-xs opacity-70">
      Tip: Make the count data-driven (e.g., 1 figure = 25k people). For Students 155k, you’d show ≈6 figures.
    </p>
  </section>

  <!-- REGIONAL BUBBLE “MAP” -->
  <section class="card p-6">
    <h2 class="text-2xl font-bold">Regional Spotlight — Where arrivals land</h2>
    <div class="map-grid mt-4">
      <!-- Left: “map” panel -->
      <div class="map-card">
        <div class="grid grid-cols-6 gap-3">
          <!-- Replace --r sizes to match your data scale -->
          <div class="col-span-2 flex items-center gap-3">
            <div class="relative" style="--r:56px">
              <div class="rounded-full" style="width:var(--r);height:var(--r);background:rgba(96,165,250,.25);border:1px solid var(--ring)"></div>
            </div>
            <div><div class="text-sm font-semibold">Ontario</div><div class="text-xs opacity-70">Largest share</div></div>
          </div>
          <div class="col-span-2 flex items-center gap-3">
            <div class="relative" style="--r:40px">
              <div class="rounded-full" style="width:var(--r);height:var(--r);background:rgba(167,139,250,.25);border:1px solid var(--ring)"></div>
            </div>
            <div><div class="text-sm font-semibold">British Columbia</div><div class="text-xs opacity-70">High student share</div></div>
          </div>
          <div class="col-span-2 flex items-center gap-3">
            <div class="relative" style="--r:42px">
              <div class="rounded-full" style="width:var(--r);height:var(--r);background:rgba(20,184,166,.25);border:1px solid var(--ring)"></div>
            </div>
            <div><div class="text-sm font-semibold">Quebec</div><div class="text-xs opacity-70">Strong TR mix</div></div>
          </div>

          <div class="col-span-2 flex items-center gap-3">
            <div class="relative" style="--r:30px">
              <div class="rounded-full" style="width:var(--r);height:var(--r);background:rgba(53,211,153,.25);border:1px solid var(--ring)"></div>
            </div>
            <div><div class="text-sm font-semibold">Alberta</div><div class="text-xs opacity-70">Work permits</div></div>
          </div>
          <div class="col-span-2 flex items-center gap-3">
            <div class="relative" style="--r:24px">
              <div class="rounded-full" style="width:var(--r);height:var(--r);background:rgba(245,158,11,.25);border:1px solid var(--ring)"></div>
            </div>
            <div><div class="text-sm font-semibold">Prairies</div><div class="text-xs opacity-70">Growing intake</div></div>
          </div>
          <div class="col-span-2 flex items-center gap-3">
            <div class="relative" style="--r:22px">
              <div class="rounded-full" style="width:var(--r);height:var(--r);background:rgba(148,163,184,.25);border:1px solid var(--ring)"></div>
            </div>
            <div><div class="text-sm font-semibold">Atlantic</div><div class="text-xs opacity-70">Provincial pilots</div></div>
          </div>
        </div>

        <p class="mt-3 text-xs opacity-70">
          Bubble sizes are illustrative. Replace with PR/TR by province to match your source data.
        </p>
      </div>

      <!-- Right: mini bars -->
      <div class="map-card">
        <h3 class="text-lg font-semibold mb-3">Mini Bars — Share by Region</h3>
        <div class="space-y-3 text-sm">
          <div>
            <div class="flex justify-between"><span>Ontario</span><span class="opacity-80">—</span></div>
            <div class="h-2 bg-white/10 rounded"><div class="h-2 rounded bg-sky-400" style="width:62%"></div></div>
          </div>
          <div>
            <div class="flex justify-between"><span>British Columbia</span><span class="opacity-80">—</span></div>
            <div class="h-2 bg-white/10 rounded"><div class="h-2 rounded" style="width:14%; background:var(--c-stu)"></div></div>
          </div>
          <div>
            <div class="flex justify-between"><span>Quebec</span><span class="opacity-80">—</span></div>
            <div class="h-2 bg-white/10 rounded"><div class="h-2 rounded" style="width:13%; background:var(--c-imp)"></div></div>
          </div>
          <div>
            <div class="flex justify-between"><span>Alberta</span><span class="opacity-80">—</span></div>
            <div class="h-2 bg-white/10 rounded"><div class="h-2 rounded" style="width:7%; background:var(--c-tfw)"></div></div>
          </div>
          <div>
            <div class="flex justify-between"><span>Prairies</span><span class="opacity-80">—</span></div>
            <div class="h-2 bg-white/10 rounded"><div class="h-2 rounded" style="width:2%; background:var(--c-econ)"></div></div>
          </div>
          <div>
            <div class="flex justify-between"><span>Atlantic</span><span class="opacity-80">—</span></div>
            <div class="h-2 bg-white/10 rounded"><div class="h-2 rounded" style="width:2%; background:var(--c-old)"></div></div>
          </div>
        </div>
        <p class="mt-3 text-xs opacity-70">
          Values are placeholders: adjust widths (%) to your source numbers.
        </p>
      </div>
    </div>
  </section>

  <!-- DATA STORYTELLING MESSAGE -->
  <section class="card p-5">
    <p class="text-sm opacity-95 leading-relaxed">
      The 2026–2028 plan captures a shift in priorities: permanent residency remains stable to provide long-term certainty,
      while temporary resident pathways are carefully adjusted to balance labour needs with capacity pressures. Student inflows
      decline to ease strain on housing and institutions, and work-permit programs stay steady to meet targeted shortages.
      Together, the data tells a story of moderation, sustainability, and a more predictable immigration future.
    </p>
  </section>

  <!-- SOURCES -->
  <section class="text-xs text-center opacity-90 py-4">
    <h3 class="font-semibold mb-1">Sources (Official IRCC Pages)</h3>
    <p class="opacity-95">
      https://www.canada.ca/en/immigration-refugees-citizenship/corporate/mandate/corporate-initiatives/levels.html
    </p>
    <p class="opacity-95 mt-2">
      https://www.canada.ca/en/immigration-refugees-citizenship/corporate/mandate/corporate-initiatives/levels/supplementary-immigration-levels-2026-2028.html
    </p>
    <p class="opacity-95 mt-2">
      https://www.canada.ca/en/immigration-refugees-citizenship/news/notices/supplementary-immigration-levels-2024-2026.html
    </p>
  </section>

</main>

<!-- CHART SCRIPT -->
<script>
document.addEventListener('DOMContentLoaded', function(){

  const css = (v)=>getComputedStyle(document.documentElement).getPropertyValue(v).trim();
  const COLOR = {
    text: css('--text'), pr: css('--c-pr'), tr: css('--c-tr'),
    econ: css('--c-econ'), old: css('--c-old'),
    imp: css('--c-imp'), tfw: css('--c-tfw'), stu: css('--c-stu')
  };

  const gridY = { color:'rgba(127,127,127,.25)' };
  const ticksX = { color:'#bcd2ea', autoSkip:true, maxTicksLimit:8 };
  const ticksY = { color:'#bcd2ea', callback:(v)=> v.toLocaleString() };

  const baseOpts = {
    responsive:true, maintainAspectRatio:false,
    plugins:{ legend:{ position:'bottom', labels:{ color:COLOR.text, font:{ size:12 } } } },
    layout:{ padding:{ top:10,right:10,bottom:4,left:6 } }
  };

  const barStyling={
    categoryPercentage:0.7, barPercentage:0.9,
    maxBarThickness:44, borderRadius:8
  };

  // Compact inline labels (no external plugins)
  const CompactLabels={
    id:'CompactLabels',
    afterDatasetsDraw(chart){
      const {ctx, config:{type}} = chart;
      ctx.save();
      ctx.font='600 11px Inter'; ctx.textAlign='center'; ctx.textBaseline='middle';

      const compact=n=> new Intl.NumberFormat('en',{notation:'compact', maximumFractionDigits:1}).format(n);
      const pill=(x,y,text)=>{
        const pad=6,h=18,w=ctx.measureText(text).width+pad*2;
        ctx.fillStyle='rgba(0,0,0,.55)';
        if(ctx.roundRect){ ctx.beginPath(); ctx.roundRect(x-w/2,y-h/2,w,h,6); ctx.fill(); }
        else{ ctx.fillRect(x-w/2,y-h/2,w,h); }
        ctx.fillStyle='#fff'; ctx.fillText(text,x,y+1);
      };

      if(type==='bar'){
        chart.data.datasets.forEach((ds,di)=>{
          const meta=chart.getDatasetMeta(di);
          meta.data.forEach((el,i)=>{
            const v=ds.data[i]; if(v==null) return;
            const p=el.tooltipPosition(); pill(p.x, p.y-12, compact(v));
          });
        });
      }
      if(type==='doughnut'){
        const ds0=chart.data.datasets[0]; const vals=ds0.data.map(Number);
        const sum=vals.reduce((a,b)=>a+b,0), meta=chart.getDatasetMeta(0);
        meta.data.forEach((arc,i)=>{ const pct=sum? (vals[i]/sum*100):0; if(pct<6) return;
          const p=arc.tooltipPosition(); pill(p.x,p.y, pct.toFixed(1)+'%');
        });
      }
      if(type==='line'){
        chart.data.datasets.forEach((ds,di)=>{
          const meta=chart.getDatasetMeta(di); const last=meta.data[meta.data.length-1]; if(!last) return;
          const v=ds.data[ds.data.length-1]; if(v==null) return; const p=last.tooltipPosition();
          pill(p.x, p.y-14, compact(v));
        });
      }

      ctx.restore();
    }
  };
  Chart.register(CompactLabels);

  /* === DATA (IRCC) === */
  // PR targets
  const PR_LABELS=['2026','2027','2028'];
  const PR_OLD=[500000,null,null];                  // Old plan (2024–2026)
  const PR_NEW=[380000,380000,380000];              // New plan (2026–2028)

  // PR class split (2026 totals)
  const CLASS_LAB=['Economic','Family','Refugee & Other'];
  const CLASS_VAL=[239800,84000,56200];

  // TR Old vs New program splits
  const TR_YEARS=['2026','2027','2028'];
  // OLD (2025–2027 plan): values for 2026–27
  const OLD_STU=[305900,305900,null];
  const OLD_IMP=[128700,155700,null];
  const OLD_TFW=[82000,82000,null];
  // NEW (2026–2028 plan)
  const NEW_STU=[155000,150000,150000];
  const NEW_IMP=[170000,170000,170000];
  const NEW_TFW=[60000,50000,50000];

  /* === CHARTS === */

  // PR Old vs New
  new Chart(document.getElementById('chartPR'),{
    type:'bar',
    data:{
      labels:PR_LABELS,
      datasets:[
        { label:'Old Plan (2024–2026)', data:PR_OLD, backgroundColor:COLOR.old, ...barStyling },
        { label:'New Plan (2026–2028)', data:PR_NEW, backgroundColor:COLOR.pr,  ...barStyling }
      ]
    },
    options:{ ...baseOpts,
      scales:{
        x:{ grid:{display:false}, ticks:ticksX, title:{display:true,text:'Year',color:COLOR.text} },
        y:{ grid:gridY, ticks:ticksY, title:{display:true,text:'People',color:COLOR.text} }
      }
    }
  });

  // PR class split (2026)
  new Chart(document.getElementById('chartClass2026'),{
    type:'doughnut',
    data:{ labels:CLASS_LAB, datasets:[{ data:CLASS_VAL, backgroundColor:[COLOR.econ, COLOR.pr, COLOR.tr], borderWidth:0 }] },
    options:{ ...baseOpts, cutout:'62%', radius:'96%' }
  });

  // TR stacked bars: two stacks per year (Old vs New). Old has 2026–27 only; New has 2026–28.
  new Chart(document.getElementById('chartTRStack'),{
    type:'bar',
    data:{
      labels:TR_YEARS,
      datasets:[
        // OLD stack
        { label:'Old • Students', data:OLD_STU, backgroundColor:'#b4a7f5', stack:'old', ...barStyling },
        { label:'Old • IMP',      data:OLD_IMP, backgroundColor:'#7fb4ff', stack:'old', ...barStyling },
        { label:'Old • TFW',      data:OLD_TFW, backgroundColor:'#32c3aa', stack:'old', ...barStyling },
        // NEW stack
        { label:'New • Students', data:NEW_STU, backgroundColor:css('--c-stu'), stack:'new', ...barStyling },
        { label:'New • IMP',      data:NEW_IMP, backgroundColor:css('--c-imp'), stack:'new', ...barStyling },
        { label:'New • TFW',      data:NEW_TFW, backgroundColor:css('--c-tfw'), stack:'new', ...barStyling }
      ]
    },
    options:{ ...baseOpts,
      scales:{
        x:{ grid:{display:false}, ticks:ticksX, title:{display:true,text:'Year',color:COLOR.text} },
        y:{ grid:gridY, ticks:ticksY, title:{display:true,text:'New TR arrivals (people)',color:COLOR.text} }
      }
    }
  });

  // Students line — Old vs New
  new Chart(document.getElementById('chartStudents'),{
    type:'line',
    data:{
      labels:TR_YEARS,
      datasets:[
        { label:'Old Plan — Students', data:OLD_STU, borderColor:'#b4a7f5', backgroundColor:'rgba(180,167,245,.18)', fill:true, tension:.35, pointRadius:3, spanGaps:true },
        { label:'New Plan — Students', data:NEW_STU, borderColor:css('--c-stu'), backgroundColor:'rgba(167,139,250,.18)', fill:true, tension:.35, pointRadius:3, spanGaps:true }
      ]
    },
    options:{ ...baseOpts,
      scales:{
        x:{ grid:{display:false}, ticks:ticksX, title:{display:true,text:'Year',color:COLOR.text} },
        y:{ grid:gridY, ticks:ticksY, title:{display:true,text:'People',color:COLOR.text} }
      }
    }
  });

});
</script>

</body>
</html>
